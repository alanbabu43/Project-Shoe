{% load static %}
<!DOCTYPE HTML>
<html>
	<head>
		<title>Footwear - Free Bootstrap 4 Template by Colorlib</title>
	   <meta charset="utf-8">
	   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	
		<link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=Rokkitt:100,300,400,700" rel="stylesheet">
		
		<!-- Animate.css -->
		<link rel="stylesheet" href="{% static 'css/animate.css' %}">
		<!-- Icomoon Icon Fonts-->
		<link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
		<!-- Ion Icon Fonts-->
		<link rel="stylesheet" href="{% static 'css/ionicons.min.css' %}">
		<!-- Bootstrap  -->
		<link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
	
		<!-- Magnific Popup -->
		<link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">
	
		<!-- Flexslider  -->
		<link rel="stylesheet" href="{% static 'css/flexslider.css' %}">
	
		<!-- Owl Carousel -->
		<link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
		<link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">
		
		<!-- Date Picker -->
		<link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">
		<!-- Flaticons  -->
		<link rel="stylesheet" href="{% static 'fonts/flaticon/font/flaticon.css' %}">
	
		<!-- Theme style  -->
		<link rel="stylesheet" href="{% static 'css/style.css' %}">
		
		<!-- icons -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

        <!-- bootstrap 5 -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

	
		</head>
        <style>
            .payment-section {
  display: flex;
  align-items: center;
}

.payment-section h4 {
  margin-right: 10px;
}
.center {
  display: flex;
  justify-content: center;
  align-items: center;
}
.popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: #4BB543;
  padding: 20px;
  text-align: center;
  color: white;
}

.popup h2 {
  margin-top: 0;
}

.popup p {
  margin-bottom: 20px;
}

.center {
  display: flex;
  justify-content: center;
  align-items: center;
}

        </style>
	<body>
		
	<div class="colorlib-loader"></div>
	<div id="page">
		<nav class="colorlib-nav" role="navigation">
			<div class="top-menu">
				<div class="container">
					<div class="row">
						<div class="col-sm-7 col-md-9">
							<div id="colorlib-logo"><a href="{% url 'home' %}">Footwear</a></div>
						</div>
						<div class="col-sm-5 col-md-3">
                            <form action="{% url 'search_brand' %}" method="post" class="search-wrap">
                                {% csrf_token %}
                               <div class="form-group">
                                  <input type="search" name="query" class="form-control search" placeholder="Search">
                                  <button class="btn btn-primary submit-search text-center" type="submit"><i class="icon-search"></i></button>
                               </div>
                            </form>
			         </div>
		         </div>
					<div class="row">
						<div class="col-sm-12 text-left menu-1">
							<ul>
								<li class="active"><a href="{% url 'home' %}">Home</a></li>
								<li><a href="{% url 'men' %}">Men</a>
								<li><a href="{% url 'women' %}">Women</a></li>
								<li><a href="about.html">About</a></li>
								{% comment %} <li><a href="contact.html">Contact</a></li> {% endcomment %}
								{% if user.is_authenticated %}
								<li class="sig"><a href="{% url 'signout' %}">{{ request.user.name }} Sign Out</a></li>
								{% else %}
								<li class="sig"><a href="{% url 'signin' %}">Sign In</a></li>
								{% endif %}
                                <li class="cart1 "><a href="{% url 'userprofile' %}"><i style="font-size:24px" class="fa">&#xf007;</i></a></li>
                                <li class="cart1"><a href="{% url 'wishlist' %}"><i style="font-size:24px" class="fa">&#xf08a;</i></a></li>
								<li class="cart"><a href="{% url 'cart' %}"><i class="icon-shopping-cart"></i> Cart </a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="sale">
				<div class="container">
					<div class="row">
						<div class="col-sm-8 offset-sm-2 text-center">
							<div class="row">
								<div class="owl-carousel2">
									<div class="item">
										<div class="col">
											<!-- <h3><a href="#">25% off (Almost) Everything! Use Code: Summer Sale</a></h3> -->
										</div>
									</div>
									<div class="item">
										<div class="col">
											<!-- <h3><a href="#">Our biggest sale yet 50% off all summer shoes</a></h3> -->
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</nav>

		<div class="breadcrumbs">
			<div class="container">
				<div class="row">
					<div class="col">
						<p class="bread"><span><a href="index.html">Home</a></span> / <span>Payment</span></p>
					</div>
				</div>
			</div>
		</div>


		<div class="colorlib-product">
			<div class="container">
				<!-- <div class="row row-pb-lg">
					<div class="col-sm-10 offset-md-1">
						<div class="process-wrap">
							<div class="process text-center active">
								<p><span>01</span></p>
								<h3>Shopping Cart</h3>
							</div>
							<div class="process text-center active">
								<p><span>02</span></p>
								<h3>Checkout</h3>
							</div>
							<div class="process text-center">
								<p><span>03</span></p>
								<h3>Order Complete</h3>
							</div>
						</div>
					</div>
				</div> -->
				<div class="row">
					<div class="col-lg-8">
						<!-- <div class="colorlib-form"> -->
							<h1>Your Billing Address</h1>
		              	<div class="row">

			            	<div class="col-md-12">
			                  <!-- <div class="form-group"> -->
                                <h2>{{adds.name}},</h2>
								<h6>{{adds.house_name}}, {{adds.address_line_1}}, {{adds.city}},<br> {{adds.state}}, Pincode: {{adds.pincode}}, {{adds.country}}, Phone number: {{adds.phone}}</h6>
								
			                  	  
			                  <!-- </div> -->
			               </div>
		               </div>
						<!-- </div> -->
					</div>

					<div class="col-lg-4">
						<div class="row">
							<div class="col-md-12">
								<div class="cart-detail">
									<h2>Cart Total</h2>
									<ul>
										<li><span>Total Items</span> <span>{{total}}</span></li>

										<li>
											
										</li>
										<!-- <li><span>Shipping Fee</span> <span>₹0.00</span></li> -->
										<li><span>Order Total</span> <span id="total_price">₹  {{sum}}</span></li>
									</ul>
								</div>
						   </div>

						   <div class="w-100"></div>

						
						</div>
					</div>
				</div>
                <div class="row">
                    <div class="col-lg-8">
						<!-- <div class="colorlib-form"> -->
							<h1>Payment Method</h1>
		              	<div class="row">
							

			            	<div class="col-md-12">
			                  <!-- <div class="form-group"> -->
                                
                                <div class="payment-section">
                                    <h4 class="ms-3">Choose:</h4>
                                    <select id="myDropdown">
                                      <option value="">Payment Method</option>
                                      <option value="cod">COD</option>
                                      <option value="razorpay">Razorpay</option>
                                    </select>
                                  </div>

								  {% if flag == 1 %}
								  <p><a role="button" class="wallet_pay btn btn-warning mt-3">Pay using Wallet</a></p> 
								  {% endif %}

								  
                                <p><a role="button" class="proceed_button btn btn-warning mt-3" onclick="showPopup()">Place Order</a></p> 

                               <!-- Pop-up overlay -->
                                <div id="overlay" class="overlay" style="display:none;">
                                    
                                    <div id="popup" class="popup" style="background-color: #4BB543; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                                        <h2 class="text-center">Order Confirmed!</h2>
                                        <p class="text-center">Your order has been successfully placed.</p>
                                        <a class="btn btn-secondary center" href="{% url 'home' %}">Close</a>
                                    </div>
                                </div>

			                  <!-- </div> -->
			               </div>
							
		               </div>
						<!-- </div> -->
					</div>
                    
                </div>
			</div>
		</div>
		<input type="hidden" id="cod_orderid" value="{{id}}">

        <script>
            var paymentMethodSelect = document.getElementById("myDropdown");
			var orderID = document.getElementById("cod_orderid").value;
  			console.log("order id",orderID)
            paymentMethodSelect.addEventListener("change", function() {
            var selectedOption = paymentMethodSelect.value;
            console.log("Selected Payment Method: " + selectedOption);
            // Perform actions based on the selected payment method
            });

            // place order button
        $(".proceed_button").on('click', function() {
        console.log("add to order button clicked")
        var dropdown = document.getElementById("myDropdown");
        var selectedOption = dropdown.options[dropdown.selectedIndex].value;

        var defaultAddressId = "{{ adds.id }}";  // Retrieve the default address ID from the Django template variable

        $.ajax({
            type: "GET",
            url: "{% url 'place_order' %}",  // Replace 'place_order' with the actual URL of your view
            data: {
                'selectedOption': selectedOption,
                'defaultAddressId': defaultAddressId,
         
            },
            success: function(data) {

                console.log("code run success")
                console.log(data.flag)
                flag = data.flag
                console.log(data.message)
                // if(flag===1){
                //     // displayPopup();
				// 	// window.location.href = "{% url 'complete_payment' %}" + "?id=" + orderID;
				// 	window.location.href = data.redirect ;

                // }
				if(data.redirect){
					console.log(data.redirect)
					window.location.href=data.redirect

				}
            }
        
        
      });
   })
    function displayPopup() {
            var overlay = document.getElementById("overlay");
            var popup = document.getElementById("popup");
            overlay.style.display = "block";
            popup.style.display = "block";
          }
      

    function closePopup() {
        var overlay = document.getElementById("overlay");
        var popup = document.getElementById("popup");
        overlay.style.display = "none";
        popup.style.display = "none";
    }

        </script>


		<footer id="colorlib-footer" role="contentinfo">
			<div class="container">
				<div class="row row-pb-md">
					<div class="col footer-col colorlib-widget">
						<h4>About Footwear</h4>
						<p>Even the all-powerful Pointing has no control about the blind texts it is an almost unorthographic life</p>
						<p>
							<ul class="colorlib-social-icons">
								<li><a href="#"><i class="icon-twitter"></i></a></li>
								<li><a href="#"><i class="icon-facebook"></i></a></li>
								<li><a href="#"><i class="icon-linkedin"></i></a></li>
								<li><a href="#"><i class="icon-dribbble"></i></a></li>
							</ul>
						</p>
					</div>
					<div class="col footer-col colorlib-widget">
						<h4>Customer Care</h4>
						<p>
							<ul class="colorlib-footer-links">
								<li><a href="#">Contact</a></li>
								<li><a href="#">Returns/Exchange</a></li>
								<li><a href="#">Gift Voucher</a></li>
								<li><a href="#">Wishlist</a></li>
								<li><a href="#">Special</a></li>
								<li><a href="#">Customer Services</a></li>
								<li><a href="#">Site maps</a></li>
							</ul>
						</p>
					</div>
					<div class="col footer-col colorlib-widget">
						<h4>Information</h4>
						<p>
							<ul class="colorlib-footer-links">
								<li><a href="#">About us</a></li>
								<li><a href="#">Delivery Information</a></li>
								<li><a href="#">Privacy Policy</a></li>
								<li><a href="#">Support</a></li>
								<li><a href="#">Order Tracking</a></li>
							</ul>
						</p>
					</div>

					<div class="col footer-col">
						<h4>News</h4>
						<ul class="colorlib-footer-links">
							<li><a href="blog.html">Blog</a></li>
							<li><a href="#">Press</a></li>
							<li><a href="#">Exhibitions</a></li>
						</ul>
					</div>

					<div class="col footer-col">
						<h4>Contact Information</h4>
						<ul class="colorlib-footer-links">
							<li>291 South 21th Street, <br> Suite 721 New York NY 10016</li>
							<li><a href="tel://1234567920">+ 1235 2355 98</a></li>
							<li><a href="mailto:info@yoursite.com">info@yoursite.com</a></li>
							<li><a href="#">yoursite.com</a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="copy">
				<div class="row">
					<div class="col-sm-12 text-center">
						<p>
							<span><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></span> 
							<span class="block">Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a> , <a href="http://pexels.com/" target="_blank">Pexels.com</a></span>
						</p>
					</div>
				</div>
			</div>
		</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="ion-ios-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="{% static 'js/jquery.min.js' %}"></script>
   <!-- popper -->
   <script src="{% static 'js/popper.min.js' %}"></script>
   <!-- bootstrap 4.1 -->
   <script src="{% static 'js/bootstrap.min.js' %}"></script>
   <!-- jQuery easing -->
   <script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
	<!-- Waypoints -->
	<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
	<!-- Flexslider -->
	<script src="{% static 'js/jquery.flexslider-min.js' %}"></script>
	<!-- Owl carousel -->
	<script src="{% static 'js/owl.carousel.min.js' %}"></script>
	<!-- Magnific Popup -->
	<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
	<script src="{% static 'js/magnific-popup-options.js' %}"></script>
	<!-- Date Picker -->
	<script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
	<!-- Stellar Parallax -->
	<script src="{% static 'js/jquery.stellar.min.js' %}"></script>
	<!-- Main -->
	<script src="{% static 'js/main.js' %}"></script>

	<script>
		$(".wallet_pay").on('click', function() {
		console.log("wallet button clicked")
		
		var defaultAddressId = "{{ adds.id }}";  // Retrieve the default address ID from the Django template variable
  
		if(!defaultAddressId){
		   alert("Address is Mandatory")
		}
		
		$.ajax({
		  type: "GET",
		  url: "{% url 'wallet_pay' %}",  // Replace 'place_order' with the actual URL of your view
		  data: {
			
			'defaultAddressId': defaultAddressId,
		   
		   
		  },
		  success: function(data) {
					console.log("code run success")
				 
					console.log(data.message)
					
					if (data.redirect) {
					   // Redirect to the specified URL
					   window.location.href = data.redirect ;
					   
					} else {
					   // Handle other response data
					   // ...
					   console.log("no redirect")
					}
				 }
		  
		  
		});
	 })
	 </script>

	</body>
</html>

